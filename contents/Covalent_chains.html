

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Covalent chains and blocks &mdash; MolSysMT 0+untagged.1.gff5879d documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sequence alignment" href="Alignment.html" />
    <link rel="prev" title="Bondgraph" href="Bondgraph.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MolSysMT
          

          
          </a>

          
            
            
              <div class="version">
                0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Installation and Quick Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Installation.html#last-stable-version">Last stable version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Installation.html#last-testing-version">Last testing version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Installation.html#developing-version-from-the-source-code">Developing version from the source code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#the-source-code">The source code</a></li>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#a-conda-environment">A conda environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#additional-dependencies-for-developers">Additional dependencies for developers</a></li>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#installation-from-the-source-code">Installation from the source code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Installation.html#patching-nglview">Patching NGLView</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#uninstallation">Uninstallation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quick Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Converting-molecular-systems">Converting molecular systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Elements-selection">Elements selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Loading-molecular-systems-and-trajectories">Loading molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Converting-molecular-systems-and-trajectories">Converting molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Working-with-id-codes">Working with id codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Working-with-sequences">Working with sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Writting-molecular-systems-or-trajectories-as-files">Writting molecular systems or trajectories as files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Atoms-selection">Atoms selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Viewing-molecular-systems-and-trajectories">Viewing molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Molecular-systems-as-MolSysMT’s-forms">Molecular systems as MolSysMT’s forms</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Forms and elements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Elements.html">Molecular system elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="Elements.html#elements">Elements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#atom">Atom</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#group">Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#component">Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#molecule">Molecule</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#chains">Chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#entities">Entities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MolSys.html">The MolSys form</a></li>
<li class="toctree-l1"><a class="reference internal" href="MolSys.html#topology">Topology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#elements">Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="MolSys.html#atom">Atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="MolSys.html#group">Group</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#component">Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#molecule">Molecule</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#chains">Chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#entities">Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#bioassemblies">Bioassemblies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MolSys.html#trajectory">Trajectory</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Basic tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Get_form.html">Get form</a></li>
<li class="toctree-l1"><a class="reference internal" href="Info.html">Info</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Info.html#As-a-DataFrame">As a DataFrame</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-atoms">Summary information on atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-groups">Summary information on groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-components">Summary information on components</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-chains">Summary information on chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-molecules">Summary information on molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-entities">Summary information on entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-a-molecular-system">Summary information on a molecular system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Info.html#As-a-string">As a string</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id1">Summary information on atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id2">Summary information on groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id3">Summary information on components</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id4">Summary information on chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id5">Summary information on molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id6">Summary information on entities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Convert.html">How to convert a form into other form</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#How-to-convert-just-a-selection">How to convert just a selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#How-to-combine-multiple-forms-into-one">How to combine multiple forms into one</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#How-to-convert-a-form-into-multiple-ones-at-once">How to convert a form into multiple ones at once</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#Some-examples-with-files">Some examples with files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#Some-examples-with-IDs">Some examples with IDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#Conversions-implemented-in-MolSysMT">Conversions implemented in MolSysMT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Selection.html">Select</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#MolSysMT-selection-syntaxis">MolSysMT selection syntaxis</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Target-selections-with-atom-indices">Target selections with atom indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Simple-atoms-selection-by-their-attributes-or-properties">Simple atoms selection by their attributes or properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Including-other-elements-attributes">Including other elements attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Including-external-variables">Including external variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Including-mask-filters">Including mask filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Selection-of-other-elements">Selection of other elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Special-selection-tools">Special selection tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Syntaxis-translation">Syntaxis translation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Selection.html#Output-syntaxis-supported">Output syntaxis supported</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Using-your-favourite-selection-syntaxis">Using your favourite selection syntaxis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Get.html">Get</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Table-with-attributes-you-can-get">Table with attributes you can get</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Some-other-examples-involving-atoms,-groups,-components,-chains,-molecules-or-entities">Some other examples involving atoms, groups, components, chains, molecules or entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Some-other-examples-involving-systems">Some other examples involving systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Some-other-examples-involving-bonds">Some other examples involving bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Getting-trajectory-times,-coordinates-and-pbc-box-attributes">Getting trajectory times, coordinates and pbc box attributes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Copy.html">Copying a molecular system</a></li>
<li class="toctree-l1"><a class="reference internal" href="Extract.html">Extracting a molecular subsystem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Extract.html#How-to-extract-a-molecular-subsystem">How to extract a molecular subsystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Remove.html">Removing atoms and frames from a molecular system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-frames">Removing frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-atoms">Removing atoms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-hydrogen-atoms">Removing hydrogen atoms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-the-solvent">Removing the solvent</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Add_Merge.html">Add and Merge</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Add_Merge.html#Adding-to-a-molecular-system">Adding to a molecular system</a></li>
<li class="toctree-l2"><a class="reference internal" href="Add_Merge.html#Merging-molecular-systems">Merging molecular systems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Append_Concatenate.html">Append and Concatenate frames</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Append_Concatenate.html#Appending-frames-to-a-molecular-system">Appending frames to a molecular system</a></li>
<li class="toctree-l2"><a class="reference internal" href="Append_Concatenate.html#Concatenating-frames-from-molecular-systems">Concatenating frames from molecular systems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="View.html">View</a><ul>
<li class="toctree-l2"><a class="reference internal" href="View.html#NGLView">NGLView</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Building tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Fix.html">Fixing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solvation.html">Adding solvent</a></li>
<li class="toctree-l1"><a class="reference internal" href="Protonation.html">Protonation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build_peptide.html">Building a peptide from its sequence</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-dipeptide-in-implicit-solvent">Alanine dipeptide in implicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-dipeptide-in-explicit-solvent">Alanine dipeptide in explicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-pentapeptide-in-implicit-solvent">Alanine pentapeptide in implicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-pentapeptide-in-explicit-solvent">Alanine pentapeptide in explicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Met-enkephalin-in-implicit-solvent">Met-enkephalin in implicit solvent</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Terminal_capping.html">Terminal capping</a></li>
<li class="toctree-l1"><a class="reference internal" href="Model_loop.html">Modeling loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="Energy_minimization.html">Potential energy and energy minimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Energy_minimization.html#Some-examples:">Some examples:</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Structural tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Geometrical_transformations.html">Geometrical transformations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Geometrical_transformations.html#Translations-and-shifts-of-cartesian-coordinates">Translations and shifts of cartesian coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="Geometrical_transformations.html#Shifts-of-dihedral-angles">Shifts of dihedral angles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Distances.html">Getting distances, neighbor lists and contact maps.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Distances.html#The-XYZ-molecular-system-form">The XYZ molecular system form</a></li>
<li class="toctree-l2"><a class="reference internal" href="Distances.html#Distance-between-atoms-in-space">Distance between atoms in space</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distance-between-atoms-of-a-system">Distance between atoms of a system</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distances-between-atoms-positions-in-different-frames">Distances between atoms positions in different frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Displacement-distances-of-atoms">Displacement distances of atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distance-between-atoms-pairs">Distance between atoms pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Minimum-and-Maximum-distance">Minimum and Maximum distance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Distances.html#Distance-between-atom-groups-in-space">Distance between atom groups in space</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distance-between-atom-groups-of-a-system">Distance between atom groups of a system</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distances-between-atom-groups-positions-in-different-frames">Distances between atom groups positions in different frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Displacement-distances-of-atom-groups">Displacement distances of atom groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distance-between-atom-groups-pairs">Distance between atom groups pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Minimum-and-Maximum-distance-of-atom-groups">Minimum and Maximum distance of atom groups</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Distances.html#Neighbor-lists">Neighbor lists</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#First-closest-neighbor-atoms-or-groups">First closest neighbor atoms or groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Closest-neighbor-atoms-or-groups-below-a-distance-threshold">Closest neighbor atoms or groups below a distance threshold</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Distances.html#Contact-maps">Contact maps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PBC.html">Periodic Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Centers.html">Getting the center and recentering</a></li>
<li class="toctree-l1"><a class="reference internal" href="RMSD.html">RMSD, Least RMSD and Least RMSD fit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="RMSD.html#RMSD">RMSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMSD.html#Least-RMSD">Least RMSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMSD.html#Least-RMSD-fit">Least RMSD fit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Rg.html">Radius of gyration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dihedral_angles.html">Dihedral angles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Dihedral_angles.html#How-to-get-any-dihedral-angle">How to get any dihedral angle</a></li>
<li class="toctree-l2"><a class="reference internal" href="Dihedral_angles.html#How-to-get-the-Ramachandran-angles">How to get the Ramachandran angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="Dihedral_angles.html#How-to-change-the-dihedral-angles-of-a-molecular-system">How to change the dihedral angles of a molecular system</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="SASA.html">Solvent Accessible Surface Area</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Topological tools</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Bondgraph.html">Bondgraph</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Covalent chains and blocks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#How-to-get-covalent-chains">How to get covalent chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="#How-to-get-the-atoms-quartets-defining-the-dihedral-angles">How to get the atoms quartets defining the dihedral angles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#\phi-(phi)"><span class="math notranslate nohighlight">\(\phi\)</span> (<code class="docutils literal notranslate"><span class="pre">phi</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#\psi-(psi)"><span class="math notranslate nohighlight">\(\psi\)</span> (<code class="docutils literal notranslate"><span class="pre">psi</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#\omega-(omega)"><span class="math notranslate nohighlight">\(\omega\)</span> (<code class="docutils literal notranslate"><span class="pre">omega</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#\chi_{1}-(chi1)"><span class="math notranslate nohighlight">\(\chi_{1}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi1</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#\chi_{2}-(chi2)"><span class="math notranslate nohighlight">\(\chi_{2}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi2</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#\chi_{3}-(chi3)"><span class="math notranslate nohighlight">\(\chi_{3}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi3</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#\chi_{4}-(chi4)"><span class="math notranslate nohighlight">\(\chi_{4}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi4</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#\chi_{5}-(chi5)"><span class="math notranslate nohighlight">\(\chi_{5}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi5</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#How-to-get-covalent-blocks">How to get covalent blocks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Alignment.html">Sequence alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mutations.html">Mutations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PhysChem and ADMET tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Polarity.html">How to get chemical and physical properties</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Polarity.html#Atoms">Atoms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Polarity.html#Mass">Mass</a></li>
<li class="toctree-l3"><a class="reference internal" href="Polarity.html#Radii">Radii</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Transmembrane_tendency.html">How to get chemical and physical properties</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Transmembrane_tendency.html#Atoms">Atoms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Transmembrane_tendency.html#Mass">Mass</a></li>
<li class="toctree-l3"><a class="reference internal" href="Transmembrane_tendency.html#Radii">Radii</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MolSysMT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Covalent chains and blocks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/contents/Covalent_chains.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">molsysmt</span> <span class="k">as</span> <span class="nn">msm</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ea6c9e94092e43a3adad34b4081cb86a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="section" id="Covalent-chains-and-blocks">
<h1>Covalent chains and blocks<a class="headerlink" href="#Covalent-chains-and-blocks" title="Permalink to this headline">¶</a></h1>
<div class="section" id="How-to-get-covalent-chains">
<h2>How to get covalent chains<a class="headerlink" href="#How-to-get-covalent-chains" title="Permalink to this headline">¶</a></h2>
<p>Lets load first of all a molecular system to work with in this section:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;1tcd.mmtf&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_c06fa_" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_waters</th>        <th class="col_heading level0 col8" >n_proteins</th>        <th class="col_heading level0 col9" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_c06fa_row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_c06fa_row0_col1" class="data row0 col1" >3983</td>
                        <td id="T_c06fa_row0_col2" class="data row0 col2" >662</td>
                        <td id="T_c06fa_row0_col3" class="data row0 col3" >167</td>
                        <td id="T_c06fa_row0_col4" class="data row0 col4" >4</td>
                        <td id="T_c06fa_row0_col5" class="data row0 col5" >166</td>
                        <td id="T_c06fa_row0_col6" class="data row0 col6" >2</td>
                        <td id="T_c06fa_row0_col7" class="data row0 col7" >165</td>
                        <td id="T_c06fa_row0_col8" class="data row0 col8" >1</td>
                        <td id="T_c06fa_row0_col9" class="data row0 col9" >1</td>
            </tr>
    </tbody></table></div>
</div>
<p>MolSysMT includes a method to get all covalent chains found in the molecular system given by a sequence of atom names. To illustrate how the method <code class="docutils literal notranslate"><span class="pre">molsysmt.covalent_chains</span></code> works lets extract all segments of atoms C, N, CA an C covalently bound in this order (C-N-CA-C):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">covalent_chains</span> <span class="o">=</span><span class="n">msm</span><span class="o">.</span><span class="n">covalent_chains</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;atom_name==&quot;C&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;N&quot;&#39;</span><span class="p">,</span>
                                                              <span class="s1">&#39;atom_name==&quot;CA&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;C&quot;&#39;</span><span class="p">],</span>
                                     <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;component_index==0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">covalent_chains</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(247, 4)
</pre></div></div>
</div>
<p>The output is a numpy array 2-ranked where the dimension of the first axe or rank is the number of chains found in the system, and the second rank has dimension 4 (since it chain was chosen to have 4 atoms):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">covalent_chains</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[   2,    9,   10,   11],
       [  11,   16,   17,   18],
       [  18,   25,   26,   27],
       ...,
       [1877, 1884, 1885, 1886],
       [1886, 1889, 1890, 1891],
       [1891, 1896, 1897, 1898]])
</pre></div></div>
</div>
<p>Lets check that the name of the atoms in any of the obtained chains is correct:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">covalent_chains</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;C&#39;, &#39;N&#39;, &#39;CA&#39;, &#39;C&#39;], dtype=object)
</pre></div></div>
</div>
<p>The atom name specified at each place does not need to be unique, we can introduce variants at any position defining the covalent chain. Lets see for instance how to get all 4 atoms covalent chains where the first three atoms are C-N-CA, in this order, and the fourth atom can either be C or CB:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">covalent_chains</span> <span class="o">=</span><span class="n">msm</span><span class="o">.</span><span class="n">covalent_chains</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;atom_name==&quot;C&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;N&quot;&#39;</span><span class="p">,</span>
                                                              <span class="s1">&#39;atom_name==&quot;CA&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==[&quot;C&quot;, &quot;CB&quot;]&#39;</span><span class="p">],</span>
                                                              <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;component_index==0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The covalent chains defining the <span class="math notranslate nohighlight">\(\phi\)</span>, <span class="math notranslate nohighlight">\(\psi\)</span>, <span class="math notranslate nohighlight">\(\omega\)</span> and , <span class="math notranslate nohighlight">\(\xi_1\)</span> dihedral angles are obtained as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Covalent chains defining all phi dihedral angles in the molecular system</span>
<span class="n">phi_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_chains</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;atom_name==&quot;C&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;N&quot;&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;atom_name==&quot;CA&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;C&quot;&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Covalent chains defining all psi dihedral angles in the molecular system</span>
<span class="n">psi_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_chains</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;atom_name==&quot;N&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;CA&quot;&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;atom_name==&quot;C&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;N&quot;&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Covalent chains defining all omega dihedral angles in the molecular system</span>
<span class="n">omega_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_chains</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;atom_name==[&quot;CA&quot;,&quot;CH3&quot;]&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;C&quot;&#39;</span><span class="p">,</span>
                                                            <span class="s1">&#39;atom_name==&quot;N&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==[&quot;CA&quot;, &quot;CH3&quot;]&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Covalent chains defining all chi1 dihedral angles in the molecular system</span>
<span class="n">chi1_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_chains</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;atom_name==&quot;N&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;CA&quot;&#39;</span><span class="p">,</span>
                                                           <span class="s1">&#39;atom_name==&quot;CB&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;CG&quot;&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="How-to-get-the-atoms-quartets-defining-the-dihedral-angles">
<h2>How to get the atoms quartets defining the dihedral angles<a class="headerlink" href="#How-to-get-the-atoms-quartets-defining-the-dihedral-angles" title="Permalink to this headline">¶</a></h2>
<p>MolSysMT includes a method to obtain the sets of atoms quartets defining all dihedral angles present in the system given their names. There is no need then to remember the atom names defining the angle <span class="math notranslate nohighlight">\(\phi\)</span>, <span class="math notranslate nohighlight">\(\psi\)</span>, <span class="math notranslate nohighlight">\(\omega\)</span>, or any of the <span class="math notranslate nohighlight">\(\chi\)</span> angles. Lets see how this method works over one of the demo molecular systems:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;1tcd.mmtf&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The quartets defining the angles <span class="math notranslate nohighlight">\(\phi\)</span>, <span class="math notranslate nohighlight">\(\psi\)</span> or <span class="math notranslate nohighlight">\(\omega\)</span> over the whole system can be obtained as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_dihedral_quartets</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s1">&#39;phi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">phi_chains</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[   2    9   10   11]
 [  11   16   17   18]
 [  18   25   26   27]
 ...
 [3789 3796 3797 3798]
 [3798 3801 3802 3803]
 [3803 3808 3809 3810]]
</pre></div></div>
</div>
<p>The search of these quartets can be limited to a specific selection. Lets see how to get the quartes of the <span class="math notranslate nohighlight">\(\psi\)</span> angles in residues 10 to 15:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">psi_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_dihedral_quartets</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s1">&#39;psi&#39;</span><span class="p">,</span>
                                            <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;10&lt;=group_index&lt;=15&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">psi_chains</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 77  78  79  86]
 [ 86  87  88  92]
 [ 92  93  94 100]
 [100 101 102 104]
 [104 105 106 110]]
</pre></div></div>
</div>
<p>Atoms chains defining <span class="math notranslate nohighlight">\(\chi\)</span> angles can be also extracted. Lets get, for instance, all <span class="math notranslate nohighlight">\(\chi_{5}\)</span> in the system:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chi5_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_dihedral_quartets</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s1">&#39;chi5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>There’s a high number of ARG residues in our system. ARG is the only amino-acide with a <span class="math notranslate nohighlight">\(\chi_{5}\)</span> dihedral angle.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">chi5_chains</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
26
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n_args</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;group_name==&quot;ARG&quot;&#39;</span><span class="p">,</span> <span class="n">n_groups</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n_args</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
26
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi_psi_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_dihedral_quartets</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s1">&#39;phi-psi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">phi_psi_chains</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(990, 4)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">phi_psi_chains</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;C&#39;, &#39;N&#39;, &#39;CA&#39;, &#39;C&#39;], dtype=object)
</pre></div></div>
</div>
<p>If all dihedral angles needs to be considered, the value ‘all’ for the input argument <code class="docutils literal notranslate"><span class="pre">dihedral_angle</span></code> returns all atoms quartets for any <span class="math notranslate nohighlight">\(\phi\)</span>, <span class="math notranslate nohighlight">\(\psi\)</span>, <span class="math notranslate nohighlight">\(\omega\)</span>, <span class="math notranslate nohighlight">\(\chi_{1}\)</span>, <span class="math notranslate nohighlight">\(\chi_{2}\)</span>, <span class="math notranslate nohighlight">\(\chi_{3}\)</span>, <span class="math notranslate nohighlight">\(\chi_{4}\)</span> and <span class="math notranslate nohighlight">\(\chi_{5}\)</span> angle:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">all_angles_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_dihedral_quartets</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">all_angles_chains</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2362, 4)
</pre></div></div>
</div>
<p>In the following tables a summary of the dihedral angle definitions are included in this document for future reference. The corresponding string taken by the input argument <code class="docutils literal notranslate"><span class="pre">dihedral_angle</span></code> is written down between parentesis next to each greek letter naming the angle:</p>
<div class="section" id="\phi-(phi)">
<h3><span class="math notranslate nohighlight">\(\phi\)</span> (<code class="docutils literal notranslate"><span class="pre">phi</span></code>)<a class="headerlink" href="#\phi-(phi)" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 18%" />
<col style="width: 23%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Residue</p></th>
<th class="head"><p>Atoms</p></th>
<th class="head"><p>Zero value</p></th>
<th class="head"><p>Range (degrees)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>all but PRO</p></td>
<td><p>C-N-CA-C</p></td>
<td><p>C cis to C</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>PRO</p></td>
<td><p>C-N-CA-C</p></td>
<td><p>C cis to C</p></td>
<td><p>~-90</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="\psi-(psi)">
<h3><span class="math notranslate nohighlight">\(\psi\)</span> (<code class="docutils literal notranslate"><span class="pre">psi</span></code>)<a class="headerlink" href="#\psi-(psi)" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 20%" />
<col style="width: 25%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Residue</p></th>
<th class="head"><p>Atoms</p></th>
<th class="head"><p>Zero value</p></th>
<th class="head"><p>Range (degrees)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>all</p></td>
<td><p>N-CA-C-N</p></td>
<td><p>N cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="\omega-(omega)">
<h3><span class="math notranslate nohighlight">\(\omega\)</span> (<code class="docutils literal notranslate"><span class="pre">omega</span></code>)<a class="headerlink" href="#\omega-(omega)" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 23%" />
<col style="width: 27%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Residue</p></th>
<th class="head"><p>Atoms</p></th>
<th class="head"><p>Zero value</p></th>
<th class="head"><p>Range (degrees)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>all</p></td>
<td><p>CA-C-N-CA</p></td>
<td><p>CA cis to CA</p></td>
<td><p>~180</p></td>
</tr>
<tr class="row-odd"><td><p>all</p></td>
<td><p>CH3-C-N-CA</p></td>
<td><p>CA cis to CA</p></td>
<td><p>~180</p></td>
</tr>
<tr class="row-even"><td><p>all</p></td>
<td><p>CA-C-N-CH3</p></td>
<td><p>CA cis to CA</p></td>
<td><p>~180</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="\chi_{1}-(chi1)">
<h3><span class="math notranslate nohighlight">\(\chi_{1}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi1</span></code>)<a class="headerlink" href="#\chi_{1}-(chi1)" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 22%" />
<col style="width: 24%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Residue</p></th>
<th class="head"><p>Atoms</p></th>
<th class="head"><p>Zero value</p></th>
<th class="head"><p>Range (degrees)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ARG</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>ASN</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>ASP</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>CYS</p></td>
<td><p>N-CA-CB-SG</p></td>
<td><p>SG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>GLN</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>GLU</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>HIS</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>ILE</p></td>
<td><p>N-CA-CB-CG1</p></td>
<td><p>CG1 cis to N</p></td>
<td><p>[-180°, 180)</p></td>
</tr>
<tr class="row-even"><td><p>LEU</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>LYS</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>MET</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>PHE</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>PRO</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>CA-CB is part of ring</p></td>
</tr>
<tr class="row-odd"><td><p>SER</p></td>
<td><p>N-CA-CB-OG</p></td>
<td><p>OG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>THR</p></td>
<td><p>N-CA-CB-OG1</p></td>
<td><p>OG1 cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>TRP</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>TYR</p></td>
<td><p>N-CA-CB-CG</p></td>
<td><p>CG cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>VAL</p></td>
<td><p>N-CA-CB-CG1</p></td>
<td><p>CG1 cis to N</p></td>
<td><p>[-180, 180)</p></td>
</tr>
</tbody>
</table>
<div class="section" id="\chi_{2}-(chi2)">
<h4><span class="math notranslate nohighlight">\(\chi_{2}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi2</span></code>)<a class="headerlink" href="#\chi_{2}-(chi2)" title="Permalink to this headline">¶</a></h4>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 23%" />
<col style="width: 25%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Residue</p></th>
<th class="head"><p>Atoms</p></th>
<th class="head"><p>Zero value</p></th>
<th class="head"><p>Range (degrees)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ARG</p></td>
<td><p>CA-CB-CG-CD</p></td>
<td><p>CD cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>ASN</p></td>
<td><p>CA-CB-CG-OD1</p></td>
<td><p>OD1 cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>ASP</p></td>
<td><p>CA-CB-CG-OD</p></td>
<td><p>OD1 cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>GLN</p></td>
<td><p>CA-CB-CG-CD</p></td>
<td><p>CD cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>GLU</p></td>
<td><p>CA-CB-CG-CD</p></td>
<td><p>CD cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>HIS</p></td>
<td><p>CA-CB-CG-ND1</p></td>
<td><p>ND1 cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>ILE</p></td>
<td><p>CA-CB-CG1-CD</p></td>
<td><p>CD cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>LEU</p></td>
<td><p>CA-CB-CG-CD1</p></td>
<td><p>CD1 cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>LYS</p></td>
<td><p>CA-CB-CG-CD</p></td>
<td><p>CD cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>MET</p></td>
<td><p>CA-CB-CG-SD</p></td>
<td><p>SD cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>PHE</p></td>
<td><p>CA-CB-CG-CD</p></td>
<td><p>CD1 cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>PRO</p></td>
<td><p>CA-CB-CG-CD</p></td>
<td><p>CD cis to CA</p></td>
<td><p>CB-CG is part of ring</p></td>
</tr>
<tr class="row-even"><td><p>TRP</p></td>
<td><p>CA-CB-CG-CD1</p></td>
<td><p>CD1 cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>TYR</p></td>
<td><p>CA-CB-CG-CD1</p></td>
<td><p>CD1 cis to CA</p></td>
<td><p>[-180, 180)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="\chi_{3}-(chi3)">
<h3><span class="math notranslate nohighlight">\(\chi_{3}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi3</span></code>)<a class="headerlink" href="#\chi_{3}-(chi3)" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 26%" />
<col style="width: 28%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Residue</p></th>
<th class="head"><p>Atoms</p></th>
<th class="head"><p>Zero value</p></th>
<th class="head"><p>Range (degrees)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ARG</p></td>
<td><p>CB-CG-CD-NE</p></td>
<td><p>NE cis to CB</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>GLN</p></td>
<td><p>CB-CG-CD-OE1</p></td>
<td><p>OE1 cis to CB</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>GLU</p></td>
<td><p>CB-CG-CD-OE1</p></td>
<td><p>OE1 cis to CB</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>LYS</p></td>
<td><p>CB-CG-CD-CE</p></td>
<td><p>CE cis to CB</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-even"><td><p>MET</p></td>
<td><p>CB-CG-SD-CE</p></td>
<td><p>CE cis to CB</p></td>
<td><p>[-180, 180)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="\chi_{4}-(chi4)">
<h3><span class="math notranslate nohighlight">\(\chi_{4}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi4</span></code>)<a class="headerlink" href="#\chi_{4}-(chi4)" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 24%" />
<col style="width: 27%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Residue</p></th>
<th class="head"><p>Atoms</p></th>
<th class="head"><p>Zero value</p></th>
<th class="head"><p>Range (degrees)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ARG</p></td>
<td><p>CG-CD-NE-CZ</p></td>
<td><p>CZ cis to CG</p></td>
<td><p>[-180, 180)</p></td>
</tr>
<tr class="row-odd"><td><p>LYS</p></td>
<td><p>CG-CD-CE-NZ</p></td>
<td><p>NZ cis to CG</p></td>
<td><p>[-180, 180)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="\chi_{5}-(chi5)">
<h3><span class="math notranslate nohighlight">\(\chi_{5}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi5</span></code>)<a class="headerlink" href="#\chi_{5}-(chi5)" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 26%" />
<col style="width: 28%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Residue</p></th>
<th class="head"><p>Atoms</p></th>
<th class="head"><p>Zero value</p></th>
<th class="head"><p>Range (degrees)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ARG</p></td>
<td><p>CD-NE-CZ-NH1</p></td>
<td><p>NH1 cis to CD</p></td>
<td><p>[-180, 180)</p></td>
</tr>
</tbody>
</table>
<p>Every dihedral angle is defined in a peptide by three vectors delimited by four consecutive covalently bonded atoms. The vector in the middle defines the orthogonal plane where rotations are defined by the projection of vectors first and third, this way two blocks of atoms change its relative positions: all atoms covalently bonded before and after the second vector in the polymer. Or explained in other words, removing the second vector two sets of covalently bonded atoms are defined. Each of
these two atoms sets move in unison when the dihedral angle changes. MolSysMT includes the input argument <code class="docutils literal notranslate"><span class="pre">with_blocks</span></code> for the method <code class="docutils literal notranslate"><span class="pre">molsysmt.covalent_dihedral_quartets</span></code> to return these atoms sets together with the quartets. Lets see how it works with an example:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">metenkephalin</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi_chains</span><span class="p">,</span> <span class="n">phi_blocks</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_dihedral_quartets</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s1">&#39;phi&#39;</span><span class="p">,</span>
                                                        <span class="n">with_blocks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Lets for instance have a look to the quartet defining the 3-th <span class="math notranslate nohighlight">\(\phi\)</span> angle:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">view</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">selection_quartet</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">to_syntaxis</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_licorice</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="n">selection_quartet</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4fa410cd58424e269fa627b6148f263f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi_blocks</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36},
       {37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71}],
      dtype=object)
</pre></div></div>
</div>
<p>Lets show in blue and red the two blocks of atoms defined by this 4-th <span class="math notranslate nohighlight">\(\phi\)</span> dihedral angle.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">view</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">selection_quartet</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">to_syntaxis</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">selection_block_0</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">phi_blocks</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="n">to_syntaxis</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">selection_block_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">phi_blocks</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="n">to_syntaxis</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_licorice</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="n">selection_quartet</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="n">selection_block_0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="n">selection_block_1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "af3072b7a19c4f899f2519c55d2af88e", "version_major": 2, "version_minor": 0}</script></div>
</div>
</div>
</div>
<div class="section" id="How-to-get-covalent-blocks">
<h2>How to get covalent blocks<a class="headerlink" href="#How-to-get-covalent-blocks" title="Permalink to this headline">¶</a></h2>
<p>In addition to getting the covalent chains, MolSysMT provides with a third method, <code class="docutils literal notranslate"><span class="pre">molsysmt.covalent_blocks</span></code>, to obtain the sets of atoms covalently bonded. In order to illustrate the results given by this method, lets load first of all a molecular system to work with it:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">metenkephalin</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>With the molecular system as the only input argument, the output corresponds to the list of sets of atoms covalently bonded.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">blocks</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_blocks</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71}]
</pre></div></div>
</div>
<p>This way the method does not offer new information. The result is nothing but the definition of the components in the system. However, using the input argument <code class="docutils literal notranslate"><span class="pre">remove_bonds</span></code> the method turns into a more interesting tool. Lets remove a couple of bonds to see the effect:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;atom&#39;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;atom_name==[&quot;C&quot;, &quot;N&quot;]&#39;</span><span class="p">,</span> <span class="n">inner_bonded_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[19, 21],
       [26, 28],
       [33, 35],
       [53, 55]])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">blocks</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_blocks</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">remove_bonds</span><span class="o">=</span><span class="p">[[</span><span class="mi">19</span><span class="p">,</span><span class="mi">21</span><span class="p">],[</span><span class="mi">33</span><span class="p">,</span><span class="mi">35</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20}
 {32, 33, 34, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31}
 {35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71}]
</pre></div></div>
</div>
<p>The output can also be return as a numpy array:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">blocks</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_blocks</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">remove_bonds</span><span class="o">=</span><span class="p">[[</span><span class="mi">19</span><span class="p">,</span><span class="mi">21</span><span class="p">],[</span><span class="mi">33</span><span class="p">,</span><span class="mi">35</span><span class="p">]],</span> <span class="n">output_form</span><span class="o">=</span><span class="s1">&#39;array&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In this case an array is returned with the index of the block each atom belongs to (0-based):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0 0 0 ... 2 2 2]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Alignment.html" class="btn btn-neutral float-right" title="Sequence alignment" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Bondgraph.html" class="btn btn-neutral float-left" title="Bondgraph" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, UIBCDF Lab at the Mexico City Childrens Hospital Federico Gomez and authors.Computational Molecular Science Python Cookiecutter version 1.5.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>