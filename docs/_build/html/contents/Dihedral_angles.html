

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Dihedral angles &mdash; MolSysMT 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Solvent Accessible Surface Area" href="SASA.html" />
    <link rel="prev" title="Radius of gyration" href="Rg.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MolSysMT
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation and Quick Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Installation.html#last-stable-version">Last stable version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Installation.html#last-testing-version">Last testing version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Installation.html#developing-version-from-the-source-code">Developing version from the source code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#the-source-code">The source code</a></li>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#a-conda-environment">A conda environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#additional-dependencies-for-developers">Additional dependencies for developers</a></li>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#installation-from-the-source-code">Installation from the source code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Installation.html#patching-nglview">Patching NGLView</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Installation.html#uninstallation">Uninstallation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quick Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Converting-molecular-systems">Converting molecular systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Elements-selection">Elements selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Loading-molecular-systems-and-trajectories">Loading molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Converting-molecular-systems-and-trajectories">Converting molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Working-with-id-codes">Working with id codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Working-with-sequences">Working with sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Writting-molecular-systems-or-trajectories-as-files">Writting molecular systems or trajectories as files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Atoms-selection">Atoms selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Viewing-molecular-systems-and-trajectories">Viewing molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Molecular-systems-as-MolSysMT’s-forms">Molecular systems as MolSysMT’s forms</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Forms and elements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Elements.html">Molecular system elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="Elements.html#elements">Elements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#atom">Atom</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#group">Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#component">Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#molecule">Molecule</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#chains">Chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#entities">Entities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MolSys.html">The MolSys form</a></li>
<li class="toctree-l1"><a class="reference internal" href="MolSys.html#topology">Topology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#elements">Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="MolSys.html#atom">Atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="MolSys.html#group">Group</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#component">Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#molecule">Molecule</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#chains">Chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#entities">Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#bioassemblies">Bioassemblies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MolSys.html#trajectory">Trajectory</a></li>
</ul>
<p class="caption"><span class="caption-text">Basic tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Get_form.html">Get form</a></li>
<li class="toctree-l1"><a class="reference internal" href="Info.html">Info</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Info.html#As-a-DataFrame">As a DataFrame</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-atoms">Summary information on atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-groups">Summary information on groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-components">Summary information on components</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-chains">Summary information on chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-molecules">Summary information on molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-entities">Summary information on entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-a-molecular-system">Summary information on a molecular system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Info.html#As-a-string">As a string</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id1">Summary information on atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id2">Summary information on groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id3">Summary information on components</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id4">Summary information on chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id5">Summary information on molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id6">Summary information on entities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Convert.html">How to convert a form into other form</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#How-to-convert-just-a-selection">How to convert just a selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#How-to-combine-multiple-forms-into-one">How to combine multiple forms into one</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#How-to-convert-a-form-into-multiple-ones-at-once">How to convert a form into multiple ones at once</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#Some-examples-with-files">Some examples with files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#Some-examples-with-IDs">Some examples with IDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#Conversions-implemented-in-MolSysMT">Conversions implemented in MolSysMT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Selection.html">Select</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#MolSysMT-selection-syntaxis">MolSysMT selection syntaxis</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Target-selections-with-atom-indices">Target selections with atom indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Simple-atoms-selection-by-their-attributes-or-properties">Simple atoms selection by their attributes or properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Including-other-elements-attributes">Including other elements attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Including-external-variables">Including external variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Including-mask-filters">Including mask filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Selection-of-other-elements">Selection of other elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Special-selection-tools">Special selection tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Syntaxis-translation">Syntaxis translation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Selection.html#Output-syntaxis-supported">Output syntaxis supported</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Using-your-favourite-selection-syntaxis">Using your favourite selection syntaxis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Get.html">Get</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Table-with-attributes-you-can-get">Table with attributes you can get</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Some-other-examples-involving-atoms,-groups,-components,-chains,-molecules-or-entities">Some other examples involving atoms, groups, components, chains, molecules or entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Some-other-examples-involving-systems">Some other examples involving systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Some-other-examples-involving-bonds">Some other examples involving bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Getting-trajectory-times,-coordinates-and-pbc-box-attributes">Getting trajectory times, coordinates and pbc box attributes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Copy.html">Copying a molecular system</a></li>
<li class="toctree-l1"><a class="reference internal" href="Extract.html">Extracting a molecular subsystem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Extract.html#How-to-extract-a-molecular-subsystem">How to extract a molecular subsystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Remove.html">Removing atoms and frames from a molecular system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-frames">Removing frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-atoms">Removing atoms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-hydrogen-atoms">Removing hydrogen atoms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-the-solvent">Removing the solvent</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Add_Merge.html">Add and Merge</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Add_Merge.html#Adding-to-a-molecular-system">Adding to a molecular system</a></li>
<li class="toctree-l2"><a class="reference internal" href="Add_Merge.html#Merging-molecular-systems">Merging molecular systems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Append_Concatenate.html">Append and Concatenate frames</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Append_Concatenate.html#Appending-frames-to-a-molecular-system">Appending frames to a molecular system</a></li>
<li class="toctree-l2"><a class="reference internal" href="Append_Concatenate.html#Concatenating-frames-from-molecular-systems">Concatenating frames from molecular systems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="View.html">View</a><ul>
<li class="toctree-l2"><a class="reference internal" href="View.html#NGLView">NGLView</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Building tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Fix.html">Fixing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solvation.html">Adding solvent</a></li>
<li class="toctree-l1"><a class="reference internal" href="Protonation.html">Protonation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build_peptide.html">Building a peptide from its sequence</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-dipeptide-in-implicit-solvent">Alanine dipeptide in implicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-dipeptide-in-explicit-solvent">Alanine dipeptide in explicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-pentapeptide-in-implicit-solvent">Alanine pentapeptide in implicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-pentapeptide-in-explicit-solvent">Alanine pentapeptide in explicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Met-enkephalin-in-implicit-solvent">Met-enkephalin in implicit solvent</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Terminal_capping.html">Terminal capping</a></li>
<li class="toctree-l1"><a class="reference internal" href="Model_loop.html">Modeling loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="Energy_minimization.html">Potential energy and energy minimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Energy_minimization.html#Some-examples:">Some examples:</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Structural tools</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Geometrical_transformations.html">Geometrical transformations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Geometrical_transformations.html#Translations-and-shifts-of-cartesian-coordinates">Translations and shifts of cartesian coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="Geometrical_transformations.html#Shifts-of-dihedral-angles">Shifts of dihedral angles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Distances.html">Getting distances, neighbor lists and contact maps.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Distances.html#The-XYZ-molecular-system-form">The XYZ molecular system form</a></li>
<li class="toctree-l2"><a class="reference internal" href="Distances.html#Distance-between-atoms-in-space">Distance between atoms in space</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distance-between-atoms-of-a-system">Distance between atoms of a system</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distances-between-atoms-positions-in-different-frames">Distances between atoms positions in different frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Displacement-distances-of-atoms">Displacement distances of atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distance-between-atoms-pairs">Distance between atoms pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Minimum-and-Maximum-distance">Minimum and Maximum distance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Distances.html#Distance-between-atom-groups-in-space">Distance between atom groups in space</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distance-between-atom-groups-of-a-system">Distance between atom groups of a system</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distances-between-atom-groups-positions-in-different-frames">Distances between atom groups positions in different frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Displacement-distances-of-atom-groups">Displacement distances of atom groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Distance-between-atom-groups-pairs">Distance between atom groups pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Minimum-and-Maximum-distance-of-atom-groups">Minimum and Maximum distance of atom groups</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Distances.html#Neighbor-lists">Neighbor lists</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#First-closest-neighbor-atoms-or-groups">First closest neighbor atoms or groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distances.html#Closest-neighbor-atoms-or-groups-below-a-distance-threshold">Closest neighbor atoms or groups below a distance threshold</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Distances.html#Contact-maps">Contact maps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PBC.html">Periodic Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Centers.html">Getting the center and recentering</a></li>
<li class="toctree-l1"><a class="reference internal" href="RMSD.html">RMSD, Least RMSD and Least RMSD fit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="RMSD.html#RMSD">RMSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMSD.html#Least-RMSD">Least RMSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMSD.html#Least-RMSD-fit">Least RMSD fit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Rg.html">Radius of gyration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dihedral angles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#How-to-get-any-dihedral-angle">How to get any dihedral angle</a></li>
<li class="toctree-l2"><a class="reference internal" href="#How-to-get-the-Ramachandran-angles">How to get the Ramachandran angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#How-to-change-the-dihedral-angles-of-a-molecular-system">How to change the dihedral angles of a molecular system</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="SASA.html">Solvent Accessible Surface Area</a></li>
</ul>
<p class="caption"><span class="caption-text">Topological tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Bondgraph.html">Bondgraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="Covalent_chains.html">Covalent chains and blocks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Covalent_chains.html#How-to-get-covalent-chains">How to get covalent chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="Covalent_chains.html#How-to-get-the-atoms-quartets-defining-the-dihedral-angles">How to get the atoms quartets defining the dihedral angles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\phi-(phi)"><span class="math notranslate nohighlight">\(\phi\)</span> (<code class="docutils literal notranslate"><span class="pre">phi</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\psi-(psi)"><span class="math notranslate nohighlight">\(\psi\)</span> (<code class="docutils literal notranslate"><span class="pre">psi</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\omega-(omega)"><span class="math notranslate nohighlight">\(\omega\)</span> (<code class="docutils literal notranslate"><span class="pre">omega</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\chi_{1}-(chi1)"><span class="math notranslate nohighlight">\(\chi_{1}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi1</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Covalent_chains.html#\chi_{2}-(chi2)"><span class="math notranslate nohighlight">\(\chi_{2}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi2</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\chi_{3}-(chi3)"><span class="math notranslate nohighlight">\(\chi_{3}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi3</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\chi_{4}-(chi4)"><span class="math notranslate nohighlight">\(\chi_{4}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi4</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\chi_{5}-(chi5)"><span class="math notranslate nohighlight">\(\chi_{5}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi5</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Covalent_chains.html#How-to-get-covalent-blocks">How to get covalent blocks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Alignment.html">Sequence alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mutations.html">Mutations</a></li>
</ul>
<p class="caption"><span class="caption-text">PhysChem and ADMET tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Polarity.html">How to get chemical and physical properties</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Polarity.html#Atoms">Atoms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Polarity.html#Mass">Mass</a></li>
<li class="toctree-l3"><a class="reference internal" href="Polarity.html#Radii">Radii</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Transmembrane_tendency.html">How to get chemical and physical properties</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Transmembrane_tendency.html#Atoms">Atoms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Transmembrane_tendency.html#Mass">Mass</a></li>
<li class="toctree-l3"><a class="reference internal" href="Transmembrane_tendency.html#Radii">Radii</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MolSysMT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Dihedral angles</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/contents/Dihedral_angles.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">molsysmt</span> <span class="k">as</span> <span class="nn">msm</span>
<span class="kn">from</span> <span class="nn">molsysmt</span> <span class="kn">import</span> <span class="n">puw</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "50aa964f4f614d21843309d0e013a931", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="section" id="Dihedral-angles">
<h1>Dihedral angles<a class="headerlink" href="#Dihedral-angles" title="Permalink to this headline">¶</a></h1>
<div class="section" id="How-to-get-any-dihedral-angle">
<h2>How to get any dihedral angle<a class="headerlink" href="#How-to-get-any-dihedral-angle" title="Permalink to this headline">¶</a></h2>
<p>Lets load a molecular systems to illustrate how MolSysMT works with the dihedral angles:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">metenkephalin</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_75f4e_" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_peptides</th>        <th class="col_heading level0 col8" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_75f4e_row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_75f4e_row0_col1" class="data row0 col1" >72</td>
                        <td id="T_75f4e_row0_col2" class="data row0 col2" >5</td>
                        <td id="T_75f4e_row0_col3" class="data row0 col3" >1</td>
                        <td id="T_75f4e_row0_col4" class="data row0 col4" >1</td>
                        <td id="T_75f4e_row0_col5" class="data row0 col5" >1</td>
                        <td id="T_75f4e_row0_col6" class="data row0 col6" >1</td>
                        <td id="T_75f4e_row0_col7" class="data row0 col7" >1</td>
                        <td id="T_75f4e_row0_col8" class="data row0 col8" >1</td>
            </tr>
    </tbody></table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">view</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "db4c0d507c17404a9df1ccc217de56c3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>A dihedral angles is defined by three vectors <span class="math notranslate nohighlight">\(\vec{O_1E_1}\)</span>, <span class="math notranslate nohighlight">\(\vec{O_2E_2}\)</span> y <span class="math notranslate nohighlight">\(\vec{O_3E_3}\)</span>, where <span class="math notranslate nohighlight">\(O_i\)</span> and <span class="math notranslate nohighlight">\(E_i\)</span> are the origin and end points of vector <span class="math notranslate nohighlight">\(i\)</span>. In molecular physics, a dihedral angle is a degree of freedom defined by three consecutive covalent bonds <span class="math notranslate nohighlight">\(\vec{O_1O_2}\)</span>, <span class="math notranslate nohighlight">\(\vec{O_2O_3}\)</span>, <span class="math notranslate nohighlight">\(\vec{O_3E_3}\)</span> where in this context <span class="math notranslate nohighlight">\(O_1\)</span>, <span class="math notranslate nohighlight">\(O_2\)</span>, <span class="math notranslate nohighlight">\(O_3\)</span> and <span class="math notranslate nohighlight">\(E_3\)</span> are the position of the atoms defining the covalent
chain. Thus, before showing how the dihedral angles are computed with <code class="docutils literal notranslate"><span class="pre">molsysmt.dihedral_angles</span></code>, lets have a look to the section ‘How to get the covalent chains’ where the methods <code class="docutils literal notranslate"><span class="pre">molsysmt.covalent_chains</span></code> and <code class="docutils literal notranslate"><span class="pre">molsysmt.covalent_dihedral_quartets</span></code> are introduced.</p>
<p>Lets first get all 4 atoms sequences in our molecular system covalently bound with the following names and order: C-N-CA-CB.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">covalent_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_chains</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;atom_name==&quot;C&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;N&quot;&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;atom_name==&quot;CA&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;atom_name==&quot;C&quot;&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">covalent_chains</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[19, 21, 23, 26],
       [26, 28, 30, 33],
       [33, 35, 37, 53],
       [53, 55, 57, 70]])
</pre></div></div>
</div>
<p>Lets have a look to the third C-N-CA-C atoms chain found in our molecular system:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">view</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">selection_quartet</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">covalent_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">to_syntaxis</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="n">selection_quartet</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "41a1eb4d138541a896fb97883bc92ed4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>The dihedral angle defined by the three consecutive vectors made by these atoms can be calculated as:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dihedral_angles</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get_dihedral_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">quartets</span><span class="o">=</span><span class="n">covalent_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dihedral_angles</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[-179.99999499104382]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>degree</td></tr></tbody></table></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">molsysmt.covalent_chains</span></code> needs as input argument the atom names defining the dihedral angle, but you probably don’t remember how <span class="math notranslate nohighlight">\(\phi\)</span> or <span class="math notranslate nohighlight">\(\psi\)</span> are defined. To keep it simple, MolSysMT includes a specific method named <code class="docutils literal notranslate"><span class="pre">molsysmt.covalent_dihedral_quartets</span></code> that accepts dihedral angles names as input argument:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">covalent_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_dihedral_quartets</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s1">&#39;phi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">covalent_chains</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[19, 21, 23, 26],
       [26, 28, 30, 33],
       [33, 35, 37, 53],
       [53, 55, 57, 70]])
</pre></div></div>
</div>
<p>The input argument ‘quartets’ accepts a list of atoms quartets to compute the corresponding dihedral angles:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dihedral_angles</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get_dihedral_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span>
                                          <span class="n">quartets</span><span class="o">=</span><span class="n">covalent_chains</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dihedral_angles</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[-179.99999499104382 -179.99999499104382 -179.99999499104382<br>  -179.99999499104382]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>degree</td></tr></tbody></table></div>
</div>
<p>The output object is a numpy array with shape: (n_frames, n_angles). As it can be checked in XXX, angles in MolSysMT are expressed in degrees.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dihedral_angles</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 4)
</pre></div></div>
</div>
<p>Lets add another molecular system to see the result when multiple frames are present:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">traj_file</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">traj_file</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
<span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/diego/Myopt/miniconda3/envs/MolSysMT_env/lib/python3.7/site-packages/tables/leaf.py:544: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify &#39;dtype=object&#39; when creating the ndarray.
  key = numpy.array(key)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_f8caa_" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_peptides</th>        <th class="col_heading level0 col8" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_f8caa_row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_f8caa_row0_col1" class="data row0 col1" >62</td>
                        <td id="T_f8caa_row0_col2" class="data row0 col2" >7</td>
                        <td id="T_f8caa_row0_col3" class="data row0 col3" >1</td>
                        <td id="T_f8caa_row0_col4" class="data row0 col4" >1</td>
                        <td id="T_f8caa_row0_col5" class="data row0 col5" >1</td>
                        <td id="T_f8caa_row0_col6" class="data row0 col6" >1</td>
                        <td id="T_f8caa_row0_col7" class="data row0 col7" >1</td>
                        <td id="T_f8caa_row0_col8" class="data row0 col8" >5000</td>
            </tr>
    </tbody></table></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">covalent_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_dihedral_quartets</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s2">&quot;phi-psi&quot;</span><span class="p">,</span>
                                                 <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;group_index==[3,4]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">covalent_chains</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2, 4)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dihedral_angles</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get_dihedral_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">quartets</span><span class="o">=</span><span class="n">covalent_chains</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dihedral_angles</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5000, 2)
</pre></div></div>
</div>
<p>We can also compute the dihedral angles for a specific set of frames:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dihedral_angles</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get_dihedral_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">quartets</span><span class="o">=</span><span class="n">covalent_chains</span><span class="p">,</span>
                                          <span class="n">frame_indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dihedral_angles</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1000, 2)
</pre></div></div>
</div>
<p>Having the atoms quartets is very convenient if the method is going to be repeated multiple times. If, however, the method is going to be applied just once, the name of the dihedral angles can be introduced as the value of the input argument <code class="docutils literal notranslate"><span class="pre">dihedral_angle</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi_angles</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get_dihedral_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s1">&#39;phi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi_angles</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5000, 5)
</pre></div></div>
</div>
<p>As well as the method <code class="docutils literal notranslate"><span class="pre">molsysmt.covalent_dihedral_quartets</span></code>, <code class="docutils literal notranslate"><span class="pre">molsysmt.get_dihedral_angles</span></code> accepts the value ‘all’ in its input argument <code class="docutils literal notranslate"><span class="pre">dihedral_angle</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">all_angles</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get_dihedral_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
                                    <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;group_index==[1,2,3]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">all_angles</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5000, 6)
</pre></div></div>
</div>
</div>
<div class="section" id="How-to-get-the-Ramachandran-angles">
<h2>How to get the Ramachandran angles<a class="headerlink" href="#How-to-get-the-Ramachandran-angles" title="Permalink to this headline">¶</a></h2>
<p>Getting the <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span> dihedral angles of a protein it is almost straightfoward with the above method. But to solve this task even more easily, MolSysMT includes a method called <code class="docutils literal notranslate"><span class="pre">molsysmt.ramachandran_angles</span></code>. Lets see how it works. But first lets load molecular system with more than a frame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">traj_file</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">traj_file</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
<span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_15a0c_" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_peptides</th>        <th class="col_heading level0 col8" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_15a0c_row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_15a0c_row0_col1" class="data row0 col1" >62</td>
                        <td id="T_15a0c_row0_col2" class="data row0 col2" >7</td>
                        <td id="T_15a0c_row0_col3" class="data row0 col3" >1</td>
                        <td id="T_15a0c_row0_col4" class="data row0 col4" >1</td>
                        <td id="T_15a0c_row0_col5" class="data row0 col5" >1</td>
                        <td id="T_15a0c_row0_col6" class="data row0 col6" >1</td>
                        <td id="T_15a0c_row0_col7" class="data row0 col7" >1</td>
                        <td id="T_15a0c_row0_col8" class="data row0 col8" >5000</td>
            </tr>
    </tbody></table></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi_chains</span><span class="p">,</span> <span class="n">psi_chains</span><span class="p">,</span> <span class="n">phi_angles</span><span class="p">,</span> <span class="n">psi_angles</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">ramachandran_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The method returns four objects, the covalent chains defining the <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span> dihedral angles and two additional objects with the corresponding values for each angle per frame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi_chains</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5, 4)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi_angles</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5000, 5)
</pre></div></div>
</div>
<p>The method also includes the posibility to limit the calculation of the ramachandran angles to an atoms selection over the molecular system:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi_chains</span><span class="p">,</span> <span class="n">psi_chains</span><span class="p">,</span> <span class="n">phi_angles</span><span class="p">,</span> <span class="n">psi_angles</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">ramachandran_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span>
                                                                         <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;group_index==[1,2]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now the ramachandran map can be plot using the algorithm you like best:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">phi_angles</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">psi_angles</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">shade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">180.0</span><span class="p">,</span><span class="mf">180.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">180.0</span><span class="p">,</span><span class="mf">180.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\phi_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\psi_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/diego/Myopt/miniconda3/envs/MolSysMT_env/lib/python3.7/site-packages/pandas/core/dtypes/cast.py:1302: UnitStrippedWarning: The unit of the quantity is stripped when downcasting to ndarray.
  v = np.array(v, copy=False)
/home/diego/Myopt/miniconda3/envs/MolSysMT_env/lib/python3.7/site-packages/pandas/core/dtypes/cast.py:1672: UnitStrippedWarning: The unit of the quantity is stripped when downcasting to ndarray.
  subarr = np.array(values, dtype=dtype, copy=copy)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/contents_Dihedral_angles_48_1.png" src="../_images/contents_Dihedral_angles_48_1.png" />
</div>
</div>
</div>
<div class="section" id="How-to-change-the-dihedral-angles-of-a-molecular-system">
<h2>How to change the dihedral angles of a molecular system<a class="headerlink" href="#How-to-change-the-dihedral-angles-of-a-molecular-system" title="Permalink to this headline">¶</a></h2>
<p>The geometry of a peptide or protein can be changed setting new values to a given dihedral angle (or a set of them). Lets see in the following lines how this can be done with the help of the method <code class="docutils literal notranslate"><span class="pre">molsysmt.set_dihedral_angles</span></code>. First of all a demo molecular system is loaded to play with it:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">metenkephalin</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_c1a3a_" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_peptides</th>        <th class="col_heading level0 col8" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_c1a3a_row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_c1a3a_row0_col1" class="data row0 col1" >72</td>
                        <td id="T_c1a3a_row0_col2" class="data row0 col2" >5</td>
                        <td id="T_c1a3a_row0_col3" class="data row0 col3" >1</td>
                        <td id="T_c1a3a_row0_col4" class="data row0 col4" >1</td>
                        <td id="T_c1a3a_row0_col5" class="data row0 col5" >1</td>
                        <td id="T_c1a3a_row0_col6" class="data row0 col6" >1</td>
                        <td id="T_c1a3a_row0_col7" class="data row0 col7" >1</td>
                        <td id="T_c1a3a_row0_col8" class="data row0 col8" >1</td>
            </tr>
    </tbody></table></div>
</div>
<p>Lets get, before changing its value, the second <span class="math notranslate nohighlight">\(\phi\)</span> angle in the current conformation of the system:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_dihedral_quartets</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s1">&#39;phi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">all_chains</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">covalent_dihedral_quartets</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[33 35 37 53]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">get_dihedral_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">quartets</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[-179.99999499104382]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>degree</td></tr></tbody></table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">view</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">selection_quartet</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">to_syntaxis</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="n">selection_quartet</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "92d894d79c7a443f943174abc3b6e725", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>Now we can rotate this angle in order to have the desired value:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">set_dihedral_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">quartets</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">angles</span><span class="o">=</span><span class="mf">0.0</span><span class="o">*</span><span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;degrees&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">view</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">selection_quartet</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">to_syntaxis</span><span class="o">=</span><span class="s1">&#39;NGLView&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="n">selection_quartet</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c465bfbf3ccc4764af3bb9093349cbc3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">get_dihedral_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">quartets</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.0]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>degree</td></tr></tbody></table></div>
</div>
<p>We can also produce a new molecular system with the angle changed making use of the input argument <code class="docutils literal notranslate"><span class="pre">in_place</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">set_dihedral_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">quartets</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                               <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;-90.0 degrees&#39;</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">get_dihedral_angles</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">quartets</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.0]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>degree</td></tr></tbody></table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">get_dihedral_angles</span><span class="p">(</span><span class="n">new_molecular_system</span><span class="p">,</span> <span class="n">quartets</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[-89.99999999999999]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>degree</td></tr></tbody></table></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">shift_dihedral_angles</span><span class="p">(</span><span class="n">new_molecular_system</span><span class="p">,</span> <span class="n">quartets</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">angles_shifts</span><span class="o">=</span><span class="s1">&#39;45.0 degrees&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">get_dihedral_angles</span><span class="p">(</span><span class="n">new_molecular_system</span><span class="p">,</span> <span class="n">quartets</span><span class="o">=</span><span class="n">phi_chains</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[-45.000000000000014]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>degree</td></tr></tbody></table></div>
</div>
<p>We can then view both structures to see the effect of the change:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">view</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">view</span><span class="p">([[</span><span class="n">molecular_system</span><span class="p">],</span> <span class="p">[</span><span class="n">new_molecular_system</span><span class="p">]])</span>
<span class="n">view</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_licorice</span><span class="p">()</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1bebb502294148688c23d74b82c53733", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">view</span><span class="o">.</span><span class="n">render_image</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cf93fc6eda51415c8055bb178d6182e8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">view</span><span class="o">.</span><span class="n">_display_image</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/contents_Dihedral_angles_71_0.png" src="../_images/contents_Dihedral_angles_71_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="SASA.html" class="btn btn-neutral float-right" title="Solvent Accessible Surface Area" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Rg.html" class="btn btn-neutral float-left" title="Radius of gyration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, UIBCDF Lab at the Mexico City Childrens Hospital Federico Gomez and authors.
             Project structure based on the Computational Molecular Science Python Cookiecutter version 1.5.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>